#!/bin/bash

jobi=$1
numjobs=$2
perdir=$3
gpfile=$4
outdir=$5
crustdir=$6

crusts=( 'sly' 'hqc18' 'eng' )

draw-gpr $gpfile -v -s $jobi -n $numjobs -N $perdir -o $outdir

for job in $(seq $jobi $(($jobi+$numjobs-1)))
do
	echo $job
	dirnum=$(($job/$perdir))
	printf -v dircode "%06d" $dirnum
	printf -v jobcode "%06d" $job
	
	crustnum=$(($RANDOM % $((${#crusts[@]}))))
	crust=${crusts[$crustnum]}
	echo "$job, $crust" >> $outdir/CRUSTS.dat

	integrate-phi $outdir/DRAWmod$perdir-$dircode/draw-gpr-$jobcode.csv 1e11 -v -o $outdir/DRAWmod$perdir-$dircode/eos-draw-$jobcode.csv --sigma-logpressurec2 0.1 --stitch-below-reference-pressure --crust-eos $crustdir/$crust.csv
done
