#!/bin/bash

# Set run parameters

binfiles=( "draweos" "getprops" "getbins" "collectbins" "weighsamps" )
args=( "arguments = \"\$(jobi) \$(numjobs) \$(perdir) \$(gpfile) \$(outdir)\"" "arguments = \"\$(jobi) \$(numjobs) \$(perdir) \$(outdir)\"" "arguments = \"\$(mpereos) \$(outdir) \$(mrng) \$(Mcrng)\"" "arguments = \"\$(Mobs) \$(outdir)\"" "arguments = \"\$(gwfile) \$(sampfile) \$(weightsfile) \$(outdir)\"" )

indir="/home/philippe.landry/eos-inf"
outdir="/home/philippe.landry/eos-inf_test"

# Print sub files

for i in $(seq 0 $((${#binfiles[@]}-1)))
do

	binfile=${binfiles[$i]}
	subfile="${outdir}/remote/${binfile}.sub"
	arg=${args[$i]}

	echo "universe = vanilla" > $subfile
	echo "executable = $indir/bin/$binfile" >> $subfile
	echo $arg >> $subfile
	echo "output = $outdir/log/JOB\$(jobi)/$binfile-\$(jobi).out" >> $subfile
	echo "error = $outdir/log/JOB\$(jobi)/$binfile-\$(jobi).err" >> $subfile
	echo "log = $outdir/log/JOB\$(jobi)/$binfile-\$(jobi).log" >> $subfile
	echo "getenv = True" >> $subfile
	echo "accounting_group = ligo.dev.o2.cbc.pe.lalinference" >> $subfile
	echo "accounting_group_user = philippe.landry" >> $subfile
	echo "queue 1" >> $subfile
done
