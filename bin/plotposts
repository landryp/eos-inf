#!/bin/bash

sampfile=$1
weightsfile=$2
gwfile=$3
dbdir=$4
outdir=$5
indir=$6
perdir=$7

kde-corner-samples -s GPprior $sampfile -s GPpost $weightsfile -s GWpost $gwfile -v --weight-column GPpost logweights --weight-column-is-log GPpost -o $outdir m1_source m2_source lambda1 lambda2 --color GPprior blue --color GPpost red --color GWpost green -r m1_source 1.25 1.75 -r m2_source 1.0 1.5 -r lambda1 0. 1500. -r lambda2 0. 2000. -b m1_source 0.02 -b m2_source 0.02 -b lambda1 10. -b lambda2 10. --reference SLY $indir/dat/REF-SLY_LAL.csv --reference H4 $indir/dat/REF-H4_LAL.csv --reference MS1 $indir/dat/REF-MS1_LAL.csv --reference-color SLY gray --reference-color H4 gray --reference-color MS1 gray --figheight 12 --figwidth 12

plotcsv $(getpaths eos-draw $sampfile -d '' -o $dbdir/ -s DRAWmod$perdir -m $perdir -n 1000) -x baryon_density -y pressurec2 -a 0.1 -d '' -o $outdir/ -L True,True -l 1e12,1e16,1e8,1e16 -m -k -A baryon_density[g/cm^3],pressurec2[g/cm^3] -t EOS -r $indir/dat/SLY_LAL.csv,$indir/dat/H4_LAL.csv,$indir/dat/MS1_LAL.csv

plotcsv $(getpaths MACROdraw $sampfile -d '' -o $dbdir/ -s DRAWmod$perdir,MACROdraw -m $perdir,1 -t -0 -n 1000) -x M -y R -a 0.1 -d '' -o $outdir/ -m -k -A M[Msun],R[km] -l 0.5,3.0,5.,25. -t MR -r $indir/dat/macro-SLY_LAL.csv,$indir/dat/macro-H4_LAL.csv,$indir/dat/macro-MS1_LAL.csv

plotcsv $(getpaths MACROdraw $sampfile -d '' -o $dbdir/ -s DRAWmod$perdir,MACROdraw -m $perdir,1 -t -0 -n 1000) -x M -y Lambda -a 0.1 -d '' -o $outdir/ -m -k -A M[Msun],Lambda -L False,True -t MLambda -r $indir/dat/macro-SLY_LAL.csv,$indir/dat/macro-H4_LAL.csv,$indir/dat/macro-MS1_LAL.csv

plot-process pressurec2 baryon_density 1e12 1e16 -s GPprior $sampfile -s GPpost $weightsfile -v --weight-column GPpost logweights --weight-column-is-log GPpost -o $outdir --eos-column GPprior EoS --eos-column GPpost EoS --eos-dir GPprior $dbdir --eos-dir GPpost $dbdir --eos-basename GPprior "eos-draw-%(draw)06d.csv" --eos-basename GPpost "eos-draw-%(draw)06d.csv" --eos-num-per-dir GPprior $perdir --eos-num-per-dir GPpost $perdir --max-num-samples GPprior 10000 --max-num-samples GPpost 10000 --color GPprior blue --color GPpost red --quantile 0.25 --quantile 0.05 --filled --legend --logcolumn pressurec2 --logcolumn baryon_density --signpost baryon_density 2.8e14 --signpost baryon_density 5.6e14 --signpost baryon_density 16.8e14

